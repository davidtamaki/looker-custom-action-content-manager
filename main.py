import json
import os
import hmac
import time
from flask import Response
from looker_sdk import client, models, error




# https://github.com/looker/actions/blob/master/docs/action_api.md#authentication
def authenticate(request):
    if request.method != 'POST':
        r =  '|ERROR| Request must be POST'; print (r)
        return Response(r, status=401, mimetype='application/json')

    elif 'authorization' not in request.headers:
        r = '|ERROR| Request does not have auth token'; print (r)
        return Response(r, status=400, mimetype='application/json')

    else:
        expected_auth_header = 'Token token="{}"'.format(os.environ.get('EXPECTED_LOOKER_SECRET_TOKEN'))
        submitted_auth = request.headers['authorization']
        if hmac.compare_digest(expected_auth_header,submitted_auth):
            return Response(status=200, mimetype='application/json')

        else:
            r = '|ERROR| Incorrect token'; print (r)
            return Response(r, status=403, mimetype='application/json')




# https://github.com/looker/actions/blob/master/docs/action_api.md#actions-list-endpoint
def action_list(request):
    auth = authenticate(request)
    if auth.status_code != 200:
        return auth

    response = { 
        "integrations": [{
            "name": os.environ.get('ACTION_NAME'),
            "label": os.environ.get('ACTION_LABEL'),
            "supported_action_types": ["cell", "query"],
            "form_url": os.environ.get('CALLBACK_URL_PREFIX') + "/action_form",
            "url": os.environ.get('CALLBACK_URL_PREFIX') + "/action_execute",
            "icon_data_uri": "data:image/png;base64,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",
            "supported_formats":["inline_json"], # json_detail has more info incl params but not required
            "supported_formattings":["unformatted"],
            "supported_visualization_formattings": ["noapply"],
            # "required_fields":[{tag:"user_id"}],
            "params": [
              {"name": "email", "label": "Email", "required": True},
              {"name": "user_id", "label": "User ID", "required": True}
            ]
        }]
    }

    print ('returning integrations json')
    return Response(json.dumps(response), status=200, mimetype='application/json')




# https://github.com/looker/actions/blob/master/docs/action_api.md#action-form-endpoint
def action_form(request):
    auth = authenticate(request)
    if auth.status_code != 200:
        return auth

    response = [
        {
        "name": "action",
        "label": "Action",
        "description": "Select the action to execute",
        "type": "select",
        "required": True,
        "default": "copy",
        "options": [
                {"name": "favorite", "label": "Favorite"},
                {"name": "unfavorite", "label": "Unfavorite"},
                {"name": "copy", "label": "Copy to Space"},
                {"name": "move", "label": "Move to Space"},
                {"name": "archive", "label": "Move to Trash"},
                {"name": "restore", "label": "Restore from Trash"},
                {"name": "schedule", "label": "Run a Scheduled Plan"},
            ]
        },
        {
        "name": "content_type",
        "label": "Content Type",
        "description": "Look, Dashboard, or Schedule?", # content type doesn't actually matter for schedules
        "type": "select",
        "required": True,
        "default": "look",
        "options": [
                {"name": "dashboard", "label": "Dashboard"},
                {"name": "look", "label": "Look"},
                {"name": "schedule", "label": "Schedule"},
            ]
        },
        {
        "name": "column_name",
        "label": "Column Name",
        "description": "Enter the column name with content/scheduled plan IDs",
        "type": "text",
        "required": True,
        "default": "look.id",
        },
        {
        "name": "variable_id",
        "label": "Variable ID (Optional)",
        "description": "Enter the space/user ID for the action",
        "type": "text",
        "required": False,
        }
      ]

    print ('returning form json')
    return Response(json.dumps(response), status=200, mimetype='application/json')




# https://github.com/looker/actions/blob/master/docs/action_api.md#action-execute-endpoint
def action_execute(request):
    auth = authenticate(request)
    if auth.status_code != 200:
        return auth

    content_type = request.headers['content-type']
    if content_type == 'application/json':

        request = request.get_json(silent=True)
        print (json.dumps(request))

        # data = json.loads(request['attachment']['data']) # for json_detail

        if request == None or not request['data']:
            r = '|ERROR| No data to process'; print (r)
            return Response(r, status=401, mimetype='application/json')

        action = request['form_params'].get('action')
        content_type = request['form_params'].get('content_type')
        column_name = request['form_params'].get('column_name')
        variable_id = request['form_params'].get('variable_id') # not required, will be None if empty
        content_ids = [d.get(column_name) for d in request['data']]
        content_ids = list(dict.fromkeys(content_ids)) # remove dups
        content_ids = [n for n in content_ids if isinstance(n,int)] # only keep ints

        print ('running {} againt these {}s: {}'.format(action, content_type, content_ids))

        if content_ids:
            try:
                handle_action(action, content_type, content_ids, variable_id)
            except:
                r = '|ERROR| Something went wrong executing API calls'; print (r)
                return Response(r, status=405, mimetype='application/json')    
        else:
            r = '|ERROR| Check column name entered and content_ids are integers'; print (r)
            return Response(r, status=401, mimetype='application/json')

    r = 'action completed successfully'; print (r)
    return Response(r, status=200, mimetype='application/json')




def handle_action(action, content_type, content_ids, variable_id):
    if action == 'favorite':
        print('favoriting content')
        favorite_unfavorite(action, content_type, content_ids, variable_id)
    elif action == 'unfavorite':
        print('unfavoriting content')
        favorite_unfavorite(action, content_type, content_ids, variable_id)
    elif action == 'copy':
        print('copying content')
        copy(action, content_type, content_ids, variable_id)
    elif action == 'move':
        print('moving content')
        move(action, content_type, content_ids, variable_id)
    elif action == 'archive':
        print('archiving content')
        archive_restore(action, content_type, content_ids, {"deleted": True})
    elif action == 'restore':
        print('restoring content')
        archive_restore(action, content_type, content_ids, {"deleted": False})
    elif action == 'schedule':
        print('running schedules')
        run_schedule(content_ids)
    else:
        print ('no action')
    return




def favorite_unfavorite(action, content_type, content_ids, user_id):
    sdk = client.setup()
    sdk.login_user(user_id)
    # TODO validate user_id 

    if action == 'favorite':
        if content_type == 'look':
            content_meta_ids = [sdk.look(c_id, fields="content_metadata_id").content_metadata_id for c_id in content_ids]
        elif content_type == 'dashboard':
            content_meta_ids = [sdk.dashboard(c_id, fields="content_metadata_id").content_metadata_id for c_id in content_ids]
        else:
            print ('need to select look or dashboard')
            return
        for n in content_meta_ids:
            # TODO check if favorite content already exists
            sdk.create_content_favorite({
                "user_id": user_id, 
                "content_metadata_id": n
            })

    elif action == 'unfavorite':
        if content_type == 'look':
            content_favorite_ids = [sdk.look(c_id, fields="content_favorite_id").content_favorite_id for c_id in content_ids]
        elif content_type == 'dashboard':
            content_favorite_ids = [sdk.dashboard(c_id, fields="content_favorite_id").content_favorite_id for c_id in content_ids]
        else:
            print ('need to select look or dashboard')
            return
        content_favorite_ids = [n for n in content_favorite_ids if isinstance(n,int)] # remove Nones
        for n in content_favorite_ids:
            sdk.delete_content_favorite(n)
    return




def copy(action, content_type, content_ids, space_id):
    sdk = client.setup()

    # TODO validate space_id 
    if content_type == 'look':
        for look_id in content_ids:
            look = sdk.look(look_id)
            new_look = {}
            new_look['space_id'] = space_id
            new_look['description'] = look.description
            new_look['title'] = look.title
            new_look['query_id'] = look.query_id
            sdk.create_look(new_look)
    elif content_type == 'dashboard':
        print ('copying dashboards is tough... use gazer')

    return




def move(action, content_type, content_ids, space_id):
    sdk = client.setup()

    # TODO validate space_id 
    for c_id in content_ids:
        if content_type == 'look':
            sdk.update_look(c_id, {"folder_id": space_id})
        elif content_type == 'dashboard':
            sdk.update_dashboard(c_id, {"folder_id": space_id})
    return




def archive_restore(action, content_type, content_ids, patch):
    sdk = client.setup()

    if content_type == 'look':
        for look_id in content_ids:
            sdk.update_look(look_id,body=patch)
            # print('Look id {} is {}d'.format(str(look_updated.id), action))

    elif content_type == 'dashboard':
        looks_to_delete = []
        for dashboard_id in content_ids:
            dashboard_looks = sdk.dashboard(dashboard_id,fields="dashboard_elements(look_id)")
            if dashboard_looks:
                looks_to_delete = looks_to_delete + [look.look_id for look in dashboard_looks.dashboard_elements]
            sdk.update_dashboard(dashboard_id,body=patch)
        looks_to_delete = list(dict.fromkeys(looks_to_delete)) # remove dups
        looks_to_delete = [n for n in looks_to_delete if isinstance(n,str)] # only keep strings (remove None) # this will turn to int in API 4.0
        for look_id in looks_to_delete:
            sdk.update_look(look_id,body=patch)
            # print('Look id {} is {}d'.format(str(look_updated.id), action))
    return 




def run_schedule(scheduled_plan_ids):
    sdk = client.setup()

    for sp_id in scheduled_plan_ids:
        sp = sdk.scheduled_plan(sp_id)
        if os.environ.get('ACTION_NAME') in sp.scheduled_plan_destination[0].type:
            print ('skipping scheduled plan sent to {}'.format(os.environ.get('ACTION_NAME'))) # prevent infinite loop
            continue

        sdk.scheduled_plan_run_once_by_id(sp_id, {})
        time.sleep(.5) # endpoint is rate limited to 10 calls per second
    return    


